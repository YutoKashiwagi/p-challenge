# 概念の説明

## エンティティ
ドメインモデルの実装であるドメインオブジェクトの一つで、以下の特徴がある

- 識別子を持ち、他のエンティティと区別できる
- 内部に他のエンティティや値オブジェクトを持てる
- 自身が持つオブジェクトの操作を調整する責務を持つ

## 値オブジェクト（VO）
ドメインモデルの実装であるドメインオブジェクトの一つで、以下の特徴がある

- idは持たないが、その値によって他のVOと区別される
- 値は不変である
  - 値が変わる時、その内部の値を変えるのではなく、新しい値を返す
- 値に関する重要な制約が記載されており、その制約を守らないと生成できない
- 何であるかだけが問題となり、誰であるか、あるいはどれであるかは問われない

## 集約
ドメインオブジェクトがそのライフサイクルの開始から終了まで正しい状態であることを保証するため、概念的な境界を設けてその外側からは更新できないようにしたもの
トランザクションをかけて更新したい単位と捉えると良い

## ユビキタス言語
業務の中で使われる専門用語のこと
ユビキタス言語を作ることで、以下のようなメリットがある
- 業務の中で出てくる概念が人によって言い方や解釈がブレるという問題が解決できる
- 開発者とドメイン・エキスパートが共通の認識を持てる

またユビキタス言語が有効なのは境界づけられたコンテキストの内部のみ。コンテキストが異なれば、同じ言葉でも違う意味になる

## 境界づけられたコンテキスト
ドメイン・モデル、ユビキタス言語が有効となる範囲のこと。この境界を越えると別の意味になる

## ドメイン
解決したい課題の領域

## ドメインサービス

複数のエンティティ・VOに跨った操作など、エンティティ・VOの振る舞いではないが、ドメインロジックとなる振る舞いを記述する層
便利だが、ここにロジックを書きすぎるとドメインモデル貧血症になるので積極的に使うべきではない

## リポジトリ

ドメイン・オブジェクトや集約を保存するストレージ。ドメインロジックの起動のための取得操作や、ドメインオブジェクトや集約の保存、更新を行う

## アプリケーション（ユースケース層と呼ばれることも）

ドメインの操作ではなく、アプリケーション固有の操作を行う層

## CQS/CQRS

処理をクエリ（値の取得のみを行い、副作用を起こさない操作）とコマンド（副作用を起こす操作）に分けて考える設計手法

メソッドレベルでクエリとコマンドを分離するのがCQS、アーキテクチャレベルで分離するのがCQRS（ここは諸説ありそうなので、ここは自分の認識）

[参考](https://qiita.com/hirodragon/items/6281df80661401f48731)

## DTO

データアクセスオブジェクト
永続化しているデータへアクセスする時、システムで使用しているプログラミング言語のデータ構造と、永続化層（DBなど）のデータ構造のインピーダンスミスマッチを吸収するAdapterとして活用する

# 境界づけられたコンテキストの実例

ユーザーの登録があるQ&Aアプリの開発においては、以下のようなコンテキストがありそう

- 認証コンテキスト
- Q&Aコンテキスト

Q&Aのコンテキストにおいてはユーザーは質問者、回答者に分かれるが、認証コンテキストにおいては両者は同じなど

# Humanエンティティを作成する

- VOをもたないバージョン
  - ![humanEntityWithoutVO](humanEntityWithoutVO.ts)
- VOを持つバージョン
  - ![humanEntityWithVO](humanEntityWithVO.ts)

# クイズ

- DDDを学習するにあたり、参考にした書籍や記事があれば教えてください
- 外部サービスや外部APIにデータを保存している場合、その外部サービスや外部APIはリポジトリとして扱ってよいでしょうか？理由も含めて教えてください
- DDDの戦術的設計、戦略的設計の違いを教えてください
